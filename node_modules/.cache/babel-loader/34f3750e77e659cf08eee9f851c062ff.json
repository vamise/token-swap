{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/mikovainio/FyFy/token-swap/node_modules/@babel/runtime/regenerator/index.js\");\n\nvar _toConsumableArray = require(\"/Users/mikovainio/FyFy/token-swap/node_modules/@babel/runtime/helpers/toConsumableArray.js\").default;\n\nvar _classCallCheck = require(\"/Users/mikovainio/FyFy/token-swap/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"/Users/mikovainio/FyFy/token-swap/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TransactionBuilder = void 0;\n\nvar web3_js_1 = require(\"@solana/web3.js\");\n\nvar TransactionBuilder = /*#__PURE__*/function () {\n  function TransactionBuilder(connection, feePayer, owner) {\n    _classCallCheck(this, TransactionBuilder);\n\n    this.connection = connection;\n    this.feePayer = feePayer;\n    this.instructions = [];\n    this.owner = owner;\n  }\n\n  _createClass(TransactionBuilder, [{\n    key: \"addInstruction\",\n    value: function addInstruction(instruction) {\n      this.instructions.push(instruction);\n      return this;\n    }\n  }, {\n    key: \"build\",\n    value: function build() {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var _this = this;\n\n        var recentBlockHash, txFields, instructions, cleanupInstructions, signers, transaction;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.connection.getRecentBlockhash(\"singleGossip\");\n\n              case 2:\n                recentBlockHash = _context3.sent.blockhash;\n                txFields = {\n                  recentBlockhash: recentBlockHash,\n                  feePayer: this.feePayer\n                };\n                instructions = [];\n                cleanupInstructions = [];\n                signers = [];\n                this.instructions.forEach(function (curr) {\n                  instructions = instructions.concat(curr.instructions);\n                  cleanupInstructions = curr.cleanupInstructions.concat(cleanupInstructions);\n                  signers = signers.concat(curr.signers);\n                });\n                transaction = new web3_js_1.Transaction(txFields);\n                transaction.add.apply(transaction, _toConsumableArray(instructions.concat(cleanupInstructions)));\n                transaction.feePayer = this.feePayer;\n                return _context3.abrupt(\"return\", {\n                  transaction: transaction,\n                  signers: signers,\n                  execute: this.owner.isKeyPair ? function () {\n                    return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                      return _regeneratorRuntime.wrap(function _callee$(_context) {\n                        while (1) {\n                          switch (_context.prev = _context.next) {\n                            case 0:\n                              return _context.abrupt(\"return\", (0, web3_js_1.sendAndConfirmTransaction)(this.connection, transaction, signers));\n\n                            case 1:\n                            case \"end\":\n                              return _context.stop();\n                          }\n                        }\n                      }, _callee, this);\n                    }));\n                  } : function () {\n                    return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                        while (1) {\n                          switch (_context2.prev = _context2.next) {\n                            case 0:\n                              throw new Error(\"Please use a Keypair for the owner parameter to enable the execute function\");\n\n                            case 1:\n                            case \"end\":\n                              return _context2.stop();\n                          }\n                        }\n                      }, _callee2);\n                    }));\n                  }\n                });\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n    }\n  }]);\n\n  return TransactionBuilder;\n}();\n\nexports.TransactionBuilder = TransactionBuilder;","map":{"version":3,"sources":["/Users/mikovainio/FyFy/token-swap/node_modules/@orca-so/sdk/dist/public/utils/web3/transactions/transaction-builder.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","TransactionBuilder","web3_js_1","require","connection","feePayer","owner","instructions","instruction","push","getRecentBlockhash","recentBlockHash","blockhash","txFields","recentBlockhash","cleanupInstructions","signers","forEach","curr","concat","transaction","Transaction","add","execute","isKeyPair","sendAndConfirmTransaction","Error"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TransactionBuilder = void 0;\nconst web3_js_1 = require(\"@solana/web3.js\");\nclass TransactionBuilder {\n    constructor(connection, feePayer, owner) {\n        this.connection = connection;\n        this.feePayer = feePayer;\n        this.instructions = [];\n        this.owner = owner;\n    }\n    addInstruction(instruction) {\n        this.instructions.push(instruction);\n        return this;\n    }\n    build() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const recentBlockHash = (yield this.connection.getRecentBlockhash(\"singleGossip\")).blockhash;\n            const txFields = {\n                recentBlockhash: recentBlockHash,\n                feePayer: this.feePayer,\n            };\n            let instructions = [];\n            let cleanupInstructions = [];\n            let signers = [];\n            this.instructions.forEach((curr) => {\n                instructions = instructions.concat(curr.instructions);\n                cleanupInstructions = curr.cleanupInstructions.concat(cleanupInstructions);\n                signers = signers.concat(curr.signers);\n            });\n            const transaction = new web3_js_1.Transaction(txFields);\n            transaction.add(...instructions.concat(cleanupInstructions));\n            transaction.feePayer = this.feePayer;\n            return {\n                transaction: transaction,\n                signers: signers,\n                execute: this.owner.isKeyPair\n                    ? () => __awaiter(this, void 0, void 0, function* () {\n                        return (0, web3_js_1.sendAndConfirmTransaction)(this.connection, transaction, signers);\n                    })\n                    : () => __awaiter(this, void 0, void 0, function* () {\n                        throw new Error(\"Please use a Keypair for the owner parameter to enable the execute function\");\n                    }),\n            };\n        });\n    }\n}\nexports.TransactionBuilder = TransactionBuilder;\n"]},"metadata":{},"sourceType":"script"}